//AUTOGENERATED CODE DO NOT EDIT
package dynamodb

import (
    "context"
    "github.com/google/uuid"
    "github.com/aws/aws-sdk-go-v2/service/dynamodb"
    "github.com/sheacloud/cloud-inventory/internal/db"
    "github.com/sheacloud/cloud-inventory/pkg/meta"
)

type DynamoDBDAO struct {
    client *dynamodb.Client
    maxRetries int
    awsDao *DynamoDBAWSDAO 
}

func (dao *DynamoDBDAO) AWS() db.AWSDAO {
    return dao.awsDao
}

func (dao *DynamoDBDAO) WriteInventoryResults(ctx context.Context, metadata *meta.InventoryResults) error {
    if metadata.InventoryUUID == "" {
        metadata.InventoryUUID = uuid.New().String()
    }
    return WriteItem(ctx, dao.client, dao.maxRetries, "cloud-inventory-inventory-results", metadata)
}

func (dao *DynamoDBDAO) WriteIngestionTimestamp(ctx context.Context, metadata *meta.IngestionTimestamp) error {
    return WriteItem(ctx, dao.client, dao.maxRetries, "cloud-inventory-ingestion-timestamps", metadata)
}

type DynamoDBAWSDAO struct {
    client *dynamodb.Client
    maxRetries int
{{range $index, $element := .Services}}	{{$element.Name}}DAO db.{{$element.ServiceCapName}}DAO
{{end}}
}

{{range $index, $element := .Services}}func (dao *DynamoDBAWSDAO) {{$element.ServiceCapName}}() db.{{$element.ServiceCapName}}DAO {
    return dao.{{$element.Name}}DAO
}
{{end}}

func NewDynamoDBDAO(client *dynamodb.Client, maxRetries int) *DynamoDBDAO {
    return &DynamoDBDAO{
        client: client,
        maxRetries: maxRetries,
        awsDao: NewDynamoDBAWSDAO(client, maxRetries),
    }
}

func NewDynamoDBAWSDAO(client *dynamodb.Client, maxRetries int) *DynamoDBAWSDAO {
    return &DynamoDBAWSDAO{
        client: client,
        maxRetries: maxRetries,
{{range $index, $element := .Services}}	{{$element.Name}}DAO: &DynamoDB{{$element.ServiceCapName}}DAO{client: client, maxRetries: maxRetries},
{{end}}
    }
}